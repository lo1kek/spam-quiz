# Спам или не спам — мини-приложение

Веб-приложение на Flask для проведения теста «спам / не спам» по набору изображений.

## Возможности

- Пользователь вводит имя и телефон, после чего отвечает на серию карточек с изображениями.
- По завершении отображается количество правильных ответов и подробный список ответов.
- Администратор просматривает результаты всех участников, экспортирует их в CSV и настраивает правильные ответы.

## Стек

- Python 3.11+
- Flask
- SQLite
- HTML + CSS (кастомная стилизация)

## Подготовка окружения

1. Создайте и активируйте виртуальное окружение (опционально):
   ```bash
   python -m venv .venv
   source .venv/bin/activate  # Windows: .venv\\Scripts\\activate
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. (Опционально) пересоздайте демонстрационные изображения:
   ```bash
   python scripts/create_demo_images.py
   ```

## Переменные окружения

Скопируйте файл `.env.example` в `.env` и при необходимости измените значения:

```env
SECRET_KEY=случайная_строка
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin
```

## Запуск

```bash
python app.py
```

Приложение будет доступно по адресу `http://127.0.0.1:5000/`.

## Деплой на Vercel

1. Установите [Vercel CLI](https://vercel.com/docs/cli) и выполните вход:
   ```bash
   npm i -g vercel
   vercel login
   ```
2. Создайте файл `vercel.json` в корне проекта со следующими настройками:
   ```json
   {
     "builds": [
       { "src": "app.py", "use": "@vercel/python" }
     ],
     "routes": [
       {
         "src": "/(.*)",
         "dest": "app.py"
       }
     ]
   }
   ```
3. Убедитесь, что зависимости перечислены в `requirements.txt` (минимум `flask`). Если файла нет, создайте его:
   ```bash
   echo "flask" > requirements.txt
   ```
4. Скопируйте переменные окружения в Vercel:
   ```bash
   vercel env add SECRET_KEY
   vercel env add ADMIN_USERNAME
   vercel env add ADMIN_PASSWORD
   ```
   Затем введите значения, соответствующие вашему `.env`.
5. Разверните приложение:
   ```bash
   vercel --prod
   ```
6. После завершения деплоя откройте выданный Vercel URL и убедитесь, что приложение работает корректно.

## Структура БД

При первом запуске автоматически создаётся база данных `spam_quiz.db` с таблицами:

- `results` — итоговые результаты пользователей.
- `answers` — ответы по каждой карточке.

## Управление карточками

Список карточек и правильных ответов хранится в `config.json`. Изображения лежат в `static/images/`.

Через админ-панель (`/admin`) можно обновлять правильные ответы для каждого изображения. Изменения сохраняются в `config.json`.

## Экспорт результатов

На странице админ-панели доступна кнопка «Экспорт CSV». Файл выгрузки содержит имя, телефон, количество правильных ответов, общее число вопросов и дату прохождения.

## Лицензия

Свободное использование для демонстрационных целей.
